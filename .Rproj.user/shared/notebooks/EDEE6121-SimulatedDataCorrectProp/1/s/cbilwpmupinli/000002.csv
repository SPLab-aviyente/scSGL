"0","```r
#Conduct the ANOVA and Kruskal-Wallis Test for each gene
source('~/Documents/Documents/Summer_2019/Mouse_Liver/Rance/snSeq-DGE/R/anova_test.R')
source('~/Documents/Documents/Summer_2019/Mouse_Liver/Rance/snSeq-DGE/R/KW_test.R')
#Here data is a dataframe of n cells as rows and p+1 columns with first p columns as p genes and the last 
#column is the dose information
mydata<-simulated.data_dose
my_data_kruskal_p_value<-KW_test(mydata)
my_data_kruskal_p_value<-p.adjust(my_data_kruskal_p_value,\"fdr\")
my_data_anova_p_value<-anova_test(mydata)
my_data_anova_p_value<-p.adjust(my_data_anova_p_value,\"fdr\")
my_data_anova_pred_dec<-ifelse(my_data_anova_p_value < 0.05, \"Positive\",\"Negative\")
my_data_anova_pred_dec_lfc<-ifelse(my_data_anova_pred_dec==\"Positive\"
       &abs(log_fold_change)>log(1.5),\"Positive\",\"Negative\")
my_data_kruskal_pred_dec<-ifelse(my_data_kruskal_p_value < 0.05, \"Positive\",\"Negative\")
my_data_kruskal_pred_dec<-factor(my_data_kruskal_pred_dec,levels = c(\"Positive\",\"Negative\"))
names(my_data_kruskal_pred_dec)<-rownames(data[[\"0\"]])
my_data_kruskal_pred_dec_lfc<-ifelse(my_data_kruskal_pred_dec==\"Positive\"
       &abs(log_fold_change)>log(1.5),\"Positive\",\"Negative\")
my_data_true_dec<-ifelse(simulated.gene.metadata$Model !=\"Unchanged\" , \"Positive\",\"Negative\")
```"
