"0","```r
#Decision for all group differential expression
#Extract the log-BF values
l_bf_multiple_01<-vector(mode = \"numeric\", length = nrow(data[[\"0\"]]))
#Get the BF values
exp_bf_multiple_01<-vector(mode = \"numeric\", length = nrow(data[[\"0\"]]))
#Calculate log-fold changes between the highest and lowest dose groups
log_fold_change<-vector()
#names(exp_bf_multiple_01) = names(log_fold_change) = rownames(data[[\"0\"]])
#Layered thresholding for BF
Decision_bf_multiple_01<-vector(mode = \"numeric\", length = nrow(data[[\"0\"]]))
# Accept Reject Thresholding for BF
Decision_bf_multiple_01_new<-vector(mode = \"numeric\", length = nrow(data[[\"0\"]]))
for (j in 1: length(bf_multiple_01))
{
  l_bf_multiple_01[j]<-bf_multiple_01[[j]]$l_Bayes_factor_01
  exp_bf_multiple_01[j]<-exp(l_bf_multiple_01[j])
  log_fold_change[j] = logFC(data[[\"0\"]][j,],data[[\"30\"]][j,])
  Decision_bf_multiple_01[j]<- ifelse(exp_bf_multiple_01[j] > 1, \"Fail to Reject H_0\",ifelse( exp_bf_multiple_01[j] <= 1 & exp_bf_multiple_01[j] > (1/3), \"Weak evidence against H_0\",ifelse(exp_bf_multiple_01[j] <= (1/3) & exp_bf_multiple_01[j] > (1/10), \"Moderate evidence against H_0\", ifelse(exp_bf_multiple_01[j] <= (1/10) & exp_bf_multiple_01[j] > (1/30), \"Substantial evidence against H_0\",ifelse(exp_bf_multiple_01[j]<= (1/30) & exp_bf_multiple_01[j]> (1/100), \" Strong evidence against H_0\", ifelse(exp_bf_multiple_01[j] <= (1/100) & exp_bf_multiple_01[j] > (1/300), \"Very strong evidence against H_0\", \"Decisive evidence against H_0\"))))))
  Decision_bf_multiple_01_new[j]<-ifelse(Decision_bf_multiple_01[j] == \"Fail to Reject H_0\" | Decision_bf_multiple_01[j] == \"Weak evidence against H_0\" |Decision_bf_multiple_01[j] ==\"Moderate evidence against H_0\", \"Negative\", \"Positive\")
}
names(exp_bf_multiple_01)<-rownames(data[[\"0\"]])
names(l_bf_multiple_01)<-rownames(data[[\"0\"]])
Decision_bf_multiple_01_new<-
    factor(Decision_bf_multiple_01_new,levels = c(\"Positive\",\"Negative\"))
names(Decision_bf_multiple_01_new)<-rownames(data[[\"0\"]])
#Decisions based on BF and log-fold change
Decision_bf_multiple_01_new_lfc<- ifelse(Decision_bf_multiple_01_new == \"Positive\" & abs(log_fold_change)> log(1.5) , \"Positive\",\"Negative\")
Decision_bf_multiple_01_new_lfc<-
    factor(Decision_bf_multiple_01_new_lfc,levels = c(\"Positive\",\"Negative\"))
#True decision found in the reference
True_decision<-ifelse(simulated.gene.metadata$Model!=\"Unchanged\",  \"Positive\",\"Negative\")
True_decision<-factor(True_decision, levels = c(\"Positive\",\"Negative\"))
True_decision<-True_decision[]
names(True_decision)<-rownames(data[[\"0\"]])
#Create a dataframe
c<-data.frame(exp_bf_multiple_01,Decision_bf_multiple_01_new,
              Decision_bf_multiple_01_new_lfc,True_decision)
colnames(c)<-c(\"BF_Test_Statistic\",\"Pred_Decision\",\"Pred_Decision_LFC\",\"True_Decision\")
rownames(c)<-rownames(data[[\"0\"]])
#Confusion Matrix for BF test
caret::confusionMatrix(c$Pred_Decision,c$True_Decision)
```"
"1","Confusion Matrix and Statistics

          Reference
Prediction Positive Negative
  Positive      686      345
  Negative     1361    17831
                                          
               Accuracy : 0.9156          
                 95% CI : (0.9117, 0.9194)
    No Information Rate : 0.8988          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.4054          
                                          
 Mcnemar's Test P-Value : < 2.2e-16       
                                          
            Sensitivity : 0.33512         
            Specificity : 0.98102         
         Pos Pred Value : 0.66537         
         Neg Pred Value : 0.92909         
             Prevalence : 0.10122         
         Detection Rate : 0.03392         
   Detection Prevalence : 0.05098         
      Balanced Accuracy : 0.65807         
                                          
       'Positive' Class : Positive        
                                          
"
"0","```r
#Confusion Matrix for BF test combined with log-fold change
caret::confusionMatrix(c$Pred_Decision_LFC,c$True_Decision)
```"
"1","Confusion Matrix and Statistics

          Reference
Prediction Positive Negative
  Positive      512      242
  Negative     1535    17934
                                         
               Accuracy : 0.9121         
                 95% CI : (0.9081, 0.916)
    No Information Rate : 0.8988         
    P-Value [Acc > NIR] : 7.287e-11      
                                         
                  Kappa : 0.329          
                                         
 Mcnemar's Test P-Value : < 2.2e-16      
                                         
            Sensitivity : 0.25012        
            Specificity : 0.98669        
         Pos Pred Value : 0.67905        
         Neg Pred Value : 0.92116        
             Prevalence : 0.10122        
         Detection Rate : 0.02532        
   Detection Prevalence : 0.03728        
      Balanced Accuracy : 0.61840        
                                         
       'Positive' Class : Positive       
                                         
"
"0","```r
#Total no of predicted DE genes
length(which(Decision_bf_multiple_01_new == \"Positive\"))
```"
"1","[1] 1031
"
